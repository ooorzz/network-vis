(function(){"use strict";var t={4834:function(t,e,s){var i=s(9242),n=s(3396);function o(t,e,s,i,o,r){const l=(0,n.up)("TopLevel");return(0,n.wg)(),(0,n.j4)(l)}var r=s(7139);function l(t,e,s,i,o,l){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("button",{onClick:e[0]||(e[0]=t=>l.Componentcombine())},"Combine Node"),(0,n._)("button",{onClick:e[1]||(e[1]=t=>l.switchlevel())},"Switch Level"),(0,n._)("p",null,(0,r.zw)(o.message),1),((0,n.wg)(),(0,n.iD)("div",{ref:"chartContainer",key:o.componentKey}))])}s(560);var a=s(8301),h={name:"TopLevel",data(){return{links1:null,nodes1:null,links2:null,nodes2:null,nodesIN:null,linksIN:null,simulation:null,svgWidth:1400,svgHeight:800,nodeRadius:16,flag:!0,componentKey:0,selectedNodes:[],componentNum:0,message:"Component Level"}},async mounted(){try{const t=await fetch("./assets/festo.json");if(!t.ok)throw new Error("Network response was not ok");const e=await t.json(),s=await fetch("./assets/FB1.json");if(!s.ok)throw new Error("Network response was not ok");const i=await s.json();this.links1=e.links.map((t=>({...t}))),this.nodes1=e.nodes.map((t=>({...t}))),this.links2=i.links.map((t=>({...t}))),this.nodes2=i.nodes.map((t=>({...t}))),this.linksIN=this.links1,this.nodesIN=this.nodes1,this.links2=this.links2.concat(this.links1),this.links2=this.links2.filter((t=>"FB1"!==t.source&&"FB1"!==t.target)),this.nodes2=this.nodes2.concat(this.nodes1),this.nodes2=this.nodes2.filter((t=>"FB1"!==t.id)),this.renderChart()}catch(t){console.error("Failed to fetch graph data: ",t)}},methods:{renderChart(){if(this.links1&&this.links2){console.log("data ok!");const s=120;var t=this.linksIN,e=this.nodesIN;const i=60,n=Math.max(e.filter((t=>1===t.group)).length,e.filter((t=>2===t.group)).length);this.svgHeight=i*(n+1),e.forEach((t=>{if(1===t.group){t.fx=s;const n=e.filter((t=>1===t.group));t.fy=i*(n.indexOf(t)+1)}if(2===t.group){t.fx=this.svgWidth-s;const i=e.filter((t=>2===t.group)),n=this.svgHeight/(i.length+1);t.fy=n*(i.indexOf(t)+1)}})),this.simulation=a.A4v(e).force("link",a.Fsl(t).id((t=>t.id)).distance(50)).force("charge",a.q5i()).force("collide",a.Hh(this.nodeRadius)).on("tick",this.ticked);const o=a.Ys(this.$refs.chartContainer).append("svg").attr("width",this.svgWidth).attr("height",this.svgHeight).attr("viewBox",[0,0,this.svgWidth,this.svgHeight]).attr("style","max-width: 100%; height: auto;");o.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","-0 -3 6 6").attr("refX",3).attr("refY",0).attr("orient","auto").attr("markerWidth",6).attr("markerHeight",6).attr("xoverflow","visible").append("svg:path").attr("d","M 0,-3 L 6,0 L 0,3").attr("fill","black");const r=o.append("g").selectAll("g").data(t).join("g");r.append("line").attr("stroke","#999").attr("stroke-opacity",.6);const l=o.append("g").attr("class","nodes").selectAll("g").data(e).join("g").join("selectedNodes").on("click",this.handleNodeClick);l.append("circle").attr("r",this.nodeRadius).attr("fill",(t=>this.assignFillColor(t))).attr("stroke","black").attr("stroke-width",1.5),l.append("text").attr("class","text-inner").attr("x",(t=>t.x)).attr("y",(t=>t.y)).attr("text-anchor","middle").attr("dominant-baseline","central").style("font-size","10px").style("fill",(t=>this.assignTextColor(t))).text((t=>t.title)),l.each((function(t){1===t.group&&a.Ys(this).append("text").attr("text-anchor","end").attr("class","text-left").attr("dominant-baseline","central").style("font-size","10px").style("fill","black").style("font-family","Times New Roman").style("font-weight","bold").text((t=>t.name)),2===t.group&&a.Ys(this).append("text").attr("text-anchor","start").attr("class","text-right").attr("dominant-baseline","central").style("font-size","10px").style("fill","black").style("font-family","Times New Roman").style("font-weight","bold").text((t=>t.name))})),l.call(a.ohM().on("start",this.dragstarted).on("drag",this.dragged).on("end",this.dragended))}},Componentcombine(){if(0===this.selectedNodes.length)return;let t=0,e=0;for(let l=0;l<this.nodes1.length;l++)if(-1===this.selectedNodes.indexOf(this.nodes1[l])){t=0,e=0;for(let s=0;s<this.links1.length;s++)this.links1[s].source.id===this.nodes1[l].id?this.selectedNodes.indexOf(this.links1[s].target)>-1&&(t+=1):this.links1[s].target.id===this.nodes1[l].id&&this.selectedNodes.indexOf(this.links1[s].source)>-1&&(e+=1);e>0&&t>0&&this.selectedNodes.push(this.nodes1[l])}this.componentNum+=1;let s=String(this.componentNum),i="Com".concat(s),n={id:i,title:"Com",group:6};console.log(n),this.nodes1.push(n);let o=this.links1;console.log(this.links1);for(let l=0;l<this.selectedNodes.length;l++){for(let t=0;t<this.links1.length;t++)if(this.selectedNodes[l].id!==this.links1[t].target.id){if(this.selectedNodes[l].id===this.links1[t].source.id)for(let e=0;e<this.nodes1.length;e++)if(this.links1[t].target.id===this.nodes1[e].id){let s={source:n,target:this.nodes1[e]};o.push(s),console.log("find link"),o.splice(t,1);break}}else for(let e=0;e<this.nodes1.length;e++)if(this.links1[t].source.id===this.nodes1[e].id){let s={source:this.nodes1[e],target:n};o.push(s),console.log("find link"),o.splice(t,1),t--;break}for(let t=0;t<this.nodes1.length;t++)if(this.selectedNodes[l].id===this.nodes1[t].id){this.nodes1.splice(t,1),console.log("find node");break}}this.links1=o;let r=!1;for(let l=0;l<this.nodes1.length;l++)if(2!==this.nodes1[l].group&&4!==this.nodes1[l].group)for(let t=this.links1.length-1;t>-.5;t--){if(this.links1[t].source.id===this.nodes1[l].id){r=!1;for(let e=0;e<this.selectedNodes.length;e++)if(this.links1[t].target.id===this.selectedNodes[e].id){r=!0;break}}r&&o.splice(t,1)}this.links1=o,console.log(this.links1),console.log(this.nodes1),this.flag&&(this.clearGraph(),this.linksIN=this.links1,this.nodesIN=this.nodes1,this.svgWidth=1400,this.svgHeight=800,this.message="Component Level",this.renderChart()),this.selectedNodes=[]},handleNodeClick(t,e){console.log("点击了节点:",e);let s=!1,i=!1;for(let n=0;n<this.selectedNodes.length;n++)if(this.selectedNodes[n].id===e.id){i=!0,s=!0,this.selectedNodes.splice(n,1);break}!i&&e.group>2.5&&4!==e.group&&(s=!0,this.selectedNodes.push(e)),console.log(this.selectedNodes),s&&(this.clearGraph(),this.renderChart())},clearGraph(){a.Ys(this.$refs.chartContainer).selectAll("*").remove()},switchlevel(){this.clearGraph(),this.flag?(this.linksIN=this.links2,this.nodesIN=this.nodes2,this.flag=!1,this.svgHeight=1200,this.svgWidth=2400,this.message="Bottom Level",this.renderChart()):(this.linksIN=this.links1,this.nodesIN=this.nodes1,this.flag=!0,this.svgWidth=1400,this.svgHeight=800,this.message="Component Level",this.renderChart())},ticked(){const t=this.$refs.chartContainer.querySelectorAll("line"),e=this.$refs.chartContainer.querySelectorAll("circle"),s=this.$refs.chartContainer.querySelectorAll(".text-inner"),i=this.$refs.chartContainer.querySelectorAll(".text-left"),n=this.$refs.chartContainer.querySelectorAll(".text-right"),o=this.$refs.chartContainer.querySelectorAll(".text-link"),r=this.$refs.chartContainer.querySelectorAll(".text-bottom");t.forEach((t=>{t.setAttribute("x1",t.__data__.source.x),t.setAttribute("y1",t.__data__.source.y),t.setAttribute("x2",t.__data__.target.x),t.setAttribute("y2",t.__data__.target.y)})),e.forEach((t=>{t.setAttribute("cx",t.__data__.x),t.setAttribute("cy",t.__data__.y)})),s.forEach((t=>{t.setAttribute("x",t.__data__.x),t.setAttribute("y",t.__data__.y)})),i.forEach((t=>{t.setAttribute("x",t.__data__.x-this.nodeRadius-20),t.setAttribute("y",t.__data__.y)})),n.forEach((t=>{t.setAttribute("x",t.__data__.x+this.nodeRadius+20),t.setAttribute("y",t.__data__.y)})),r.forEach((t=>{t.setAttribute("x",t.__data__.x),t.setAttribute("y",t.__data__.y+this.nodeRadius+10)})),o.forEach((t=>{t.setAttribute("x",.5*(t.__data__.source.x+t.__data__.target.x)),t.setAttribute("y",.5*(t.__data__.source.y+t.__data__.target.y))}))},dragstarted(t){t.active||this.simulation.alphaTarget(.3).restart(),t.subject.fx=t.subject.x,t.subject.fy=t.subject.y},dragged(t,e){1===e.group||2===e.group||(t.subject.fx=t.x),t.subject.fy=t.y},dragended(t,e){t.active||this.simulation.alphaTarget(0),1!==e.group&&2!==e.group&&(t.subject.fx=null),t.subject.fy=null},assignFillColor(t){for(let e=0;e<this.selectedNodes.length;e++)if(this.selectedNodes[e].id===t.id)return"#B0B0B0";return 1===t.group?"#1f77b4":2===t.group?"green":4===t.group?"#fff2cc":5===t.group?"#7f7f7f":6===t.group?"orange":"white"},assignTextColor(t){return 1===t.group||2===t.group?"white":"black"}},beforeUnmount(){this.simulation&&this.simulation.stop()}},d=s(89);const c=(0,d.Z)(h,[["render",l]]);var u=c,f={name:"App",components:{TopLevel:u}};const g=(0,d.Z)(f,[["render",o]]);var p=g,k=s(2483);const _=[{path:"/top-level",component:u}],m=(0,k.p7)({history:(0,k.PO)("/network-vis/"),routes:_});var v=m,x=s(65),b=(0,x.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,i.ri)(p).use(b).use(v).mount("#app")}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,i,n,o){if(!i){var r=1/0;for(d=0;d<t.length;d++){i=t[d][0],n=t[d][1],o=t[d][2];for(var l=!0,a=0;a<i.length;a++)(!1&o||r>=o)&&Object.keys(s.O).every((function(t){return s.O[t](i[a])}))?i.splice(a--,1):(l=!1,o<r&&(r=o));if(l){t.splice(d--,1);var h=n();void 0!==h&&(e=h)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[i,n,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var n,o,r=i[0],l=i[1],a=i[2],h=0;if(r.some((function(e){return 0!==t[e]}))){for(n in l)s.o(l,n)&&(s.m[n]=l[n]);if(a)var d=a(s)}for(e&&e(i);h<r.length;h++)o=r[h],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(d)},i=self["webpackChunksiemens_vis"]=self["webpackChunksiemens_vis"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(4834)}));i=s.O(i)})();
//# sourceMappingURL=app.05f50c17.js.map